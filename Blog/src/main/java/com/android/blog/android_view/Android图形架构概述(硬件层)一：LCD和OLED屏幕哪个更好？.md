# Android图形架构概述(上)：硬件和屏幕驱动

对于应用开发工程师来说，虽然我们不需要写驱动程序，但是了解View是最终如何显示到屏幕上还是非常有必要的

本篇是View系列的第一篇文章，主要讨论的是Android手机屏幕的种类以及和屏幕相关的技术名词

View系列起源是因为学(划)习(水)群里有群友问，这都2022年了还有人不会自定义View，然后就被另一位字节大佬怼到自闭

前排提醒，想要学习自定义View的同学可以点击这里，可能是全网最好的教程之一，

为鹏鹏写的系列文章，希望鹏鹏看完后能有所收获

相信读完本文后

比如屏幕刷新率和FPS是什么关系，两者有什么区别与联系

为什么有的应用在90HZ屏幕体验良好，在120HZ屏幕上很卡顿

身为应用开发工程师，我们能做哪些优化来提升用户体验等等问题都得出自己的答案

## 一、开篇

手机屏幕发展至今，市场上在售手机的屏幕类型基本可以分为两种：LCD屏和OLED屏

其实不只是手机屏幕，电脑和电视屏幕面板基本也就这两种

我们平时在买屏幕时看到的IPS屏幕，TN屏等都属于LCD屏阵营，他们的区别只是液晶层结构或者背光模组结构不同

OLED屏幕因为价格比较贵，寿命也比不过LCD屏，所以OLED在显示器和电视机领域还没有大面积应用

但在手机圈，各大厂商自2020年之后生产的旗舰机，几乎都标配OLED屏幕

相较于LCD屏幕

- OLED屏幕支持更高的亮度、对比度以及更艳丽的色彩
- 更快的响应速度，高刷体验更好
- 不需要背光板，采用COP方案封装，理论上可以去掉宽下巴

在手机屏幕追求超高屏占比的时代，LCD被彻底的抛下车

但是，虽然OLED屏有许多LCD无法比拟的优势，但它同时也带了两个新的问题：烧屏和低频PWM调光

### OLED屏缺陷：烧屏

烧屏指的是手机屏幕长时间停留在某个静止画面，特别是极个别高对比度画面，再切换到其他画面时仍然能看到原来画面的残影，而且残影不会消失

比如我之前在拼多多上买的二手Pixel 3就发现老化烧屏的现象

我是图片

仔细观察位置信息一栏会发现，在屏幕上残留的有谷歌邮箱的图标icon

如今厂商用各种方案为OLED延长使用寿命，例如定期改变虚拟导航栏的位置、定期调节色温等等，但是现阶段烧屏问题还是会普遍存在的OLED屏幕上

烧屏是一个不可逆的过程，一旦手机出现烧屏，会严重影响日常的使用体验，不能忍的话只能换屏幕或者换手机

B站评论截图

### 为什么OLED会烧屏？

我们先来看LCD屏和OLED屏的结构组成

LCD是由背光模组，下偏光片，液晶层，滤光层和上偏光片组成，通过改变施加在液晶层上的电压大小来控制每个像素点颜色

我是图片

OLED是有机发光材料作发光层，发光层上方有一层低功函数的金属电极，构成如三明治的结构，通过改变施加在自发光二极管上的电压大小来控制每个红黄蓝子像素亮度，进而改变每个像素点的颜色

我是图片

*对OLED发光原理感兴趣的可以看这篇文章《[OLED发光原理和OLED面板结构及OLED关键技术深度图文解析](http://www.51touch.com/technology/touchpanel/201808/28-51282.html)》，文中的知识点大而全，从发光原理到驱动技术再到制造和封装全流程无死角覆盖*

**LCD屏幕基板**是无机玻璃材料，所以几乎不会发生老化，而**OLED基板**是**有机塑料材料**，就意味着它会渐渐老化

那么问题来了，LCD要么全亮要么全灭，所以就算老化，也是全部老化，你也看不出来

OLED由于每个像素点是自发光，而不是LCD那样整块全部亮，这就会导致OLED每个像素点工作的时间不一样

有的像素点显示蓝色的时间长，那么他的蓝色衰减就会比其他像素点多，日后再显示蓝色的时候这一个像素点的蓝色就要比其余的淡一点，同样的红色和绿色也是一样

所以OLED屏幕非常容易发生一个现象就是烧屏，本质就是屏幕老化不均匀导致的残留

### 如何减缓烧屏过程

既然OLED烧屏不可避免，作为消费者我们可以做些什么来减缓烧屏现象呢？

除了定期更换壁纸、调短屏幕**自动锁定**的时间等手段外，我个人发现了一个更好的方案，能够从根本上解决烧屏的可能性：read more books, read more newspapers, eat less snacks and sleep more

### OLED屏缺陷：低频PWM调光

低频PWM调光是OLED屏上另一个被人诟病的问题，甚至因为有人无法接受，从而诞生出“LCD永不为奴”党，注意我这里用的是“低频”

绝大多数OLED屏幕都是使用PWM调光，PWM本身没问题，只要速度够快人眼是感知不到的

开局放图

### PWM调光原理

首先我们需要了解什么是“视觉残留”现象，当人看到一幅画面快速闪过时，这幅画面产生的视觉刺激会在大脑中停留几十到几百毫秒时间，亮度越亮，停留的时间越长

这一特征我们称为视觉残留



以我手里的[Pixel 3](https://www.notebookcheck.net/Google-Pixel-3-Smartphone-Review.366326.0.html#toc-9)举例，PWM调光频率为245HZ

对自己手机屏幕参数感兴趣的同学可以去这个网站查询：www.notebookcheck.net

低频的PWM调光会给眼睛带来额外的负担，而且如果频率太低，还可能引发癫痫

PWM周期、原理、占空比

OLED屏幕烧屏和低频PWM调光都已经介绍完了，各大手机厂商也都在积极解决

比如黑鲨手机加入定制显示芯片在低亮度下做出补偿

当然LCD永不为奴党

苹果最后一代使用旗舰芯片的手机是iPhone 11

Android阵营，黑鲨游戏手机

通常是三层结构组成，最底层是显示屏，然后是触摸屏，最上面一层是玻璃

应用在手机上的触摸屏基本都是电容屏，没什么好介绍的

文章的最后我们来讨论一下，高刷屏对于工程师的挑战

对于硬件工程师来说，大部分主板上CPU和GPU共享一块内存，所以屏幕色深值越高，描述每个像素点需要内存就越大，内存的大小和内存的访问速度绝不能拉胯
屏幕刷新率高了，CPU和GPU需要在更短的时间处理数据，在提升硬件性能的同时还需要平衡功耗控制

对于应用开发工程师来说，在View绘制，做好性能优化这块展开可以聊很久

## 参考资料

- 走进自带光芒的有机发光二极管（OLED）材料绚丽多彩世界，领悟前沿的研究进展：http://www.cailiaoniu.com/232822.html
- 有机发光二极管| 8优点和缺点：https://zh-cn.lambdageeks.com/organic-light-emitting-diodes/
- [OLED发光原理和OLED面板结构及OLED关键技术深度图文解析](http://www.51touch.com/technology/touchpanel/201808/28-51282.html)
- PWM调光科普(上篇)：人类显示器的黑历史：https://www.igao7.com/news/201807/oJMDaPCKHbeufGdI.html