####五层模型

实体层、链接层、网络层、传输层、应用层

####一、实体层

负责传输01电信号

####二、链接层

单纯的01没有任何意义，多少个电信号算一组？每个信号位有何意义？这就是链接层的功能，确定01的分组方式

**以太网协议：**通用的通信协议，以太网规定一组电信号构成一个数据包，叫做帧，每一帧分为两个部分，标头head和数据data

网卡的地址：MAC地址

以太网在本网络中广播发送，每台计算机自行判断是否为接收方，head包含接收方的mac地址

有了数据包的定义、网卡的mac地址、广播的发送方式，链接层就可以在多台计算机之间传输数据了

**总结**

链接层采用广播发送的方式进行通信，链接层解决同一网络的通信维内托

####三、网络层

网联网是无数子网络共同组成的巨型网络，假设上海发送消息给杭州，依靠以太网协议寻找mac地址的方法，每台机器接受信号自行判断，基本不可能

so

这就导致了'网络层'的诞生，它的作用是引进一套新地址：网络地址，简称网址

这样每台设备就有了两个地址，一个是管理员分配的ip地址，用来确定计算机所在的子网络

另一个则是mac网卡地址

#####ip协议

ipv4有32个二进制组成，也就是4个8位，范围从0.0.0.0到255.255.255.255

每个设备都会有ip地址，ip地址分两部分，前一部分标识网络，后一部分代表主机

假设ip地址为：192.168.0.1，前24位(192.168.0)是网络部分，1是主机部分

**子网掩码**

辅助ip地址，用于标定ip前多少位是网络部分，它规定了网络部分全部为1，主机为0

还是上一个例子，假设子网255.255.255.0，则代表前24个都为网络部分

**ip数据包**

包含在以太网协议中的data部分

ip数据包也分为标头和数据

**ARP协议**

我的理解是ip和mac的映射，两台设备在同一个子网络中，会向子网络发送ARP协议，子网络中有设备回应的话就知道互相的mac地址了。不在同一子网络就交给网关gateway处理

**总结**

网络层解决设备间在网络通信的问题

#### 四、传输层

有了ip和mac地址，我们可以在互联网上任意两台主机建立通信

那么接下来的问题是，QQ、微信进程需要聊天，主机不知道把信息给谁

所以还需要一个参数，用于表示数据包供哪个进程使用，这个参数就叫做端口port，它其实是每一个使用网卡的程序进程的标号

端口是0-65525的证书，其中0-1023是系统占用

**UDP**

加上端口号的数据包，同样有标头和数据两部分组成

**TCP**

有确认机制的UDP协议

**总结**

传输层解决端对端的问题

####五、应用层

数据放在TCP数据包的data部分

**HTTP**

发展历程：

HTTP1.1 引用长连接，默认不关闭

HTTP2.0 二进制，多路复用

报文格式：

X509TrustManager

tips：

1. 如何确定一次通信完成了呢？

   报文头有Content-Length，代表响应体的字节数

   如何是Transfer-Encoding，一行行读，第一行代表字节数，第二行代表数据，如何字节数为0标识结束

#### 其他

**上网设置**

设备上网必须包含：

1. 本地的ip地址
2. 子网掩码
3. 网关的ip地址
4. DNS的ip地址

**DHCP协议**

动态ip地址

由来：每次静态设置太麻烦，所以衍生出动态ip

每个子网络中，有一台计算机负责管理本网络的所有ip地址，叫做DHCP服务器(就是路由器)

设备开机后向子网络发送请求地址消息，路由器收到后回应

**DNS协议**

发送数据包首页要知道对方的ip地址，访问www.baidu.com时，会先向DNS服务器请求ip地址，DNS服务器做出响应，然后我们再去请求

**TCP连接的建立与释放**

三次建联过程

1. Client->server 

   客户端发起连接请求

   C：老子发送个连接请求

   S：爸爸收到了，看来你的发送能力没有问题

2. Server->Client

   服务端收到请求并回复，这时服务端知道客户端发送能力没问题

   S：儿砸，爸爸告诉你，爸爸不但能收到消息，还能回复你

   C：收到了，看来鳖孙能收能发

3. Client->server

   客户端收到回复，客户端知道服务端收发都没问题，那么回复服务端：老子也知道了

   C：老子告诉你，老子收到你的回复了

   S：看来儿砸接收能力也没问题，可以开战了

四次挥手过程

1. Client->Server
2. Server->Client
3. Server->Client
4. Client->Server

#### 网络代理

#####Socks代理

代理所有socket的请求

#####Http代理

代理http的请求

http代理分为普通代理和隧道代理

#### 问题分析

##### HTTP常见状态码

1. 2xx 成功，200
2. 3xx 重定向，客户端重新发起请求，301，302
3. 4xx 请求错误，400 BadRquest，403 服务器禁止访问资源，404找不到
4. 5xx 服务器内部错误