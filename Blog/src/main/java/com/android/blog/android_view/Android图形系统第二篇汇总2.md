### Android图形系统（二）驱动层：垂直同步到底要不要开？

对于应用开发工程师来说，虽然我们不需要写驱动程序，但是了解View最终是如何显示到屏幕上还是非常有必要的

本篇是Android图形系列的第二篇文章，依旧是一些关于屏幕的名词解释，和Android系统本身没有太大关系，相较于第一篇文章，本篇重点在于介绍“屏幕刷新机制”相关的知识点

### 一、开篇

在打游戏时屏幕偶尔会出现“画面撕裂”的情况，就是屏幕的上半部分和下半部分分开了

我是撕裂图片

去网上搜“画面撕裂怎么解决”？有人说打开游戏的“垂直同步”选项就好了

底下评论又说不要开垂直同步，开了之后不但显卡会被“锁帧”，还会带来屏幕画面延迟，弊大于利

为什么两边的对于“垂直同步”的看法不一样？垂直同步到底是个什么东西？

更加让人疑惑的是：显示器为什么会发生画面撕裂？

这一切的一切都得从“刷新率”和“帧率”开始讲起

#### 1、什么是屏幕刷新率

刷新率的概念诞生自CRT显示器，早期的CRT屏幕显示画面是靠电子束激发屏幕内表面的荧光粉来显示图像的；由于荧光粉被点亮后很快会熄灭，所以电子枪必须循环地不断激发这些点

电子束从左到右、从上到下点亮荧光粉的过程，被称为“逐行扫描”技术

在一秒钟内电子束能够扫描出一幅完整画面的速度，被称为屏幕的刷新率，表示单位为HZ

我是动图

60HZ屏幕就是显示器一秒钟显示60次画面，即1/60秒内出一个画面

LCD液晶屏和OLED屏同样使用“逐行扫描”来刷新屏幕像素，不过由于显示原理发生了变化，屏幕的每个像素点都可以单独控制是否发光，所以正常情况下LCD/OLED屏会一行或者多行同时更新像素

这种技术被称为有源矩阵驱动，也就是市场上主流的TFT-LCD屏和AMOLED屏

我是雷军AMOLED屏幕图片

##### 屏幕刷新率能不能超频？

以前的大屁股显示器出厂后电子束的扫描速度就固定了，几乎不可能更改

现在的LCD液晶屏和OLED屏就不一样了，一块完整的显示设备主要由显示器件、驱动电路、控制器这三部分组成，刷新率就是写在某个地方的一个值，我们只要能修改掉这个值，就可以实现“屏幕超频”

> - PC端可以在显卡的控制面板中自定义屏幕刷新率
> - 笔记本端可以下载Custom Resolution Utility(简称CRU)写入EDID信息来修改屏幕刷新率
> - Android端可以下载酷安大佬做的“RR屏幕刷新率”APP修改屏幕刷新率，除了APP外，Android端还可以通过adb命令修改frame rate值、刷系统内核的来修改刷新率
> - Mac端可以使用SwitchResX软件来修改屏幕刷新率，这个方案我自己没试过，万一黑屏报废了就不好玩了，写篇文章而已不至于搭上台电脑
> - iPhone端可以把手机寄给我，自己先买部Android手机用，然后去看Android端如何超频的

我是pixel手机截屏

我手里Pixel 3就被我超频到61HZ了，它原先只有可怜的60HZ

对于LCD液晶屏和OLCD屏幕来说，刷新率的高低取决于两点：

一是屏幕自身素质，通常是指屏幕的“灰阶响应时间”，刷新率设置过高会导致屏幕偏色、拖影等问题

二是配套的硬件素质，屏幕供电、贷款总线等，刷新率过高可能导致屏幕无法正常工作，比如显示器黑屏、触摸屏失灵

想要了解屏幕的详细信息可以去[屏库](https://www.panelook.cn/)上查询，最后还是要提醒大家，超频有风险，刷机需谨慎

#### 2、什么是帧率

帧率有两种含义，在视频领域中，帧率表示的是每秒所包含的画面数量，拍摄参数为60帧，每秒就记录60副画面，播放

在带有图形用户界面（Graphical User Interface）的计算机系统中，帧率表示由CPU或者GPU实时渲染出来的画面数量

通常是指计算机每秒能输出的画面数量，或者是视频的帧率，通常用每秒传输帧数Frames Per Second（简称FPS）来表示帧率的大小

而视频帧率又要分为拍摄和播放两个部分，影视飓风团队有一期专门讲“视频帧率”的视频，我这就不再展开介绍了[传送门](https://www.bilibili.com/video/BV1kE411c7yZ)

本章的关心的重点是实时画面，也就是CPU或者GPU渲染出来的画面

帧率越高，画面就越流畅

##### 帧率和刷新率不匹配会怎样？

这就是为什么会出现画面撕裂的原因

### 二、垂直同步与三重缓冲

前一章我们介绍了画面为什么会撕裂的原因，本章来讲一讲画面撕裂如何解决？



什么是帧率？

什么是帧率？

