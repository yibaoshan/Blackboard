# Android图形系统（二）驱动层：高刷屏给硬件工程师带来哪些挑战？

对于应用开发工程师来说，虽然我们不需要写驱动程序，但是了解View最终是如何显示到屏幕上还是非常有必要的

本篇是Android图形系列的第二篇文章，依旧是一些关于屏幕的名词解释，和Android系统本身没有太大关系，相较于第一篇文章，本篇重点在于介绍“屏幕刷新机制”相关的知识点



“屏幕刷新”涉及到许多技术名词：逐行扫描、隔行扫描、刷新率、帧率、画面撕裂、垂直同步信号、双重缓存、三重缓冲等等，单独去了解其中的某一个词可能会觉得很容易理解，但将它们组合在一起时，情况就可能会变得更复杂一些

比如：

> **帧率与刷新率的区别，帧率是不是一定要和刷新率匹配，不匹配时多出来的帧率是不是浪费了？**
>
> **垂直同步信号的出现是为了解决什么问题？**
>
> **为什么电脑开启了垂直同步后感觉更卡了？**
>
> **有的应用在60HZ屏幕体验很好，反而在120HZ屏幕上却出现卡顿，为什么？**
>
> **既然刷新率越高体验越好，那厂商干嘛不直接出10000HZ的屏幕？**
>
> **高刷屏给硬件工程师带来哪些挑战？**
>
> **...**

本篇文章将会带着大家一起去寻找上述问题的答案，去探寻这些技术诞生的背后发生了哪些故事

前排提示：

> - **为了更好的理解每项技术诞生的背景，强烈建议按照文章的顺序进行阅读**
> - **文章不涉及代码，非技术人员可以放心食用**

以下，enjoy：

overview图片

## 一、开篇

手机屏幕发展至今，市场上在售手机的屏幕类型基本可以分为两种：**LCD屏和OLED屏**

其实不只是手机屏幕，**电脑**和**电视**屏幕面板基本也就这两种

早在LCD屏和OLED屏诞生之前，我们使用的显示器大多都是CRT显示器，小时候看的大屁股彩电、街机厅里面的接机也都是CRT显示器的一种

![image_android_view_v2_crt_overview](/Users/bob/Desktop/Bob/work/workspace/androidstudio/Blackboard/Blog/src/main/java/com/android/blog/android_view/imgs/second/image_android_view_v2_crt_overview.gif)

*图片来源：https://gfycat.com/courageousunhealthyirishdraughthorse-computing-recycling-backlit-cathode*

屏幕刷新的一些技术名次都和CRT显示器有关，为了后续的剧情能够正常发展，我们需要先来了解一下这个快被遗忘的老家伙



### 显示器的鼻祖：CRT

CRT显示器学名为“阴极射线显像管”，是一种使用阴极射线管（Cathode Ray Tube）的显示器，主要有五部分组成：电子枪、偏转线圈、荫罩、高压石墨电极和荧光粉涂层

![image_android_view_v2_crt_dismantle](/Users/bob/Desktop/Bob/work/workspace/androidstudio/Blackboard/Blog/src/main/java/com/android/blog/android_view/imgs/second/image_android_view_v2_crt_dismantle.jpg)

*图片来源：[《计算机图形学基础（第3版）》](https://www.amazon.cn/dp/B07R4LNRR6)*

用一句话来总结CRT屏幕的显示原理：

> **CRT屏幕是靠电子枪发射的电子束，激发涂有荧光层的屏幕内表面的荧光粉来显示图像的**

回顾之前在《[Android图形系统（一）硬件层：LCD和OLED怎么选？](https://juejin.cn/post/7094171161570836517)》中介绍的LCD屏幕和OLED屏幕显示原理：

> - **LCD是液晶面板，控制液晶层电压就可以改变像素颜色**
> - **OLED是自发光二极管，控制单个二极管的电压就可以改变像素颜色**

对比三者的工作原理可以发现，结构上CRT显示器必须要有一根真空管，这也导致CRT显示器没办法做的很薄

想象一下一台大尺寸的CRT电视机比家里的墙还要厚是什么样的体验..

LCD屏幕在诞生之初虽然在亮度和对比度上不如CRT，但是LCD可以做的更大更薄呀，所以CRT显示器在后来的市场竞争中慢慢的就被淘汰了



## 二、屏幕是如何刷新的？

好了，这下我们有三种类型的显示器屏幕了，分别是CRT、LCD和OLED，接下来我们一起来看看这三种屏幕是如何刷新的？

### CRT的显示基础：逐行扫描

我们知道了CRT是由电子束轰击点亮荧光粉来显示图形的，而荧光粉的特性就是被点亮后很快就会熄灭了，所以电子枪需要一刻不停的扫描

那答案就显而易见了：快速扫描

CRT显示器使用的扫描方式有很多，比如直线式扫描，圆形扫描，螺旋扫描等等，电视机没信号时看到的雪花屏就是螺旋式扫描

我们今天要介绍的是直线式扫描中的“逐行扫描”和“隔行扫描”

- **逐行扫描**

> 逐行扫描是最原始的扫描方式，电视机诞生之初使用的就是逐行扫描
>
> 逐行扫描的意思很简单：在一块CRT的屏幕上，电子枪按照从左到右、从上到下的顺序移动发射电子束的方式就叫做逐行扫描

- **隔行扫描**

> 隔行扫描是在逐行扫描的基础上修改的，把原来一行行向下扫描改成了隔一行扫描一行

![image_android_view_v2_crt_scan](/Users/bob/Desktop/Bob/work/workspace/androidstudio/Blackboard/Blog/src/main/java/com/android/blog/android_view/imgs/second/image_android_view_v2_crt_scan.gif)

如图所示，隔行扫描第一次会先扫描奇数行，第二次会扫描偶数行，两次扫描结束后才是一幅完整的图形

**隔行扫描和上面的逐行扫描的效果相比，图像的清晰度会稍差，并且还会有轻微的闪烁**

那为什么还要发明隔行扫描呢？

- **隔行扫描的诞生背景**

> 早期的广播电视播放内容比较单一，大部分是文字广告和音乐之类的内容，电影还是使用“电影放映机”来播放的
>
> 电视机发明后，人们想把电影节目也搬到电视节目当中，但是当时的广播电视传输带宽不够，所以人们就想了个办法：将一幅画面的数据按照奇偶数拆成两场，其中奇数行称为上场，偶数行称为下场，分成两次传输
>
> 电视机每次接收到的也是半幅画面，在PAL制式和NTSC制式中，显示器接受到数据后会先显示奇数行，再显示偶数行，两次显示后凑成一幅完整的图像
>
> 再后来，DVD被发明出来，相当于电视机播放的是本地视频，广播传输的带宽不再是瓶颈，所以后来的CRT电视机逐行和隔行都支持，我们小的时候看的大屁股电视，只要带有DVD接口的都是可以兼容两种不同的扫描方式的



### LCD：大人 时代变了

时间来到了1968年，第一块LCD液晶屏横空出世了

经过了36年的发展，在2004年年末爆发了液晶电视革命，LCD液晶屏幕在亮度、色域、可视角度等各种参数上都完虐老大哥CRT；和液晶屏幕比，CRT屏幕除了在刷新率上有优势外，其他方面都是弟弟

于是乎从2005年开始，夏普、松下、三菱等各大屏幕厂商都陆续宣布停产CRT显示器

2012年，随着最后一家CRT显示器厂家**彩虹电子**宣布停产，CRT时代彻底宣告落幕

扯远了，言归正传，继续来说液晶屏刷新的事儿

- **LCD液晶屏刷新原理**

> LCD液晶屏摆脱了电子枪的约束，屏幕上每个像素点都可以直接寻址，无需等待电子光束到来才能更新
>
> 这就让LCD的刷新方式和CRT截然不同，所以之前在CRT上使用的逐行扫描和隔行扫描技术，并不能适用在LCD屏幕上
>
> 但是我们经常能看到很多科普文章介绍说LCD屏幕也是逐行刷新的，这是为什么？
>
> 原因也很简单，

原图来自哔站的视频，我自己做的动图

从图中可以看到，LCD更新像素时，都是几行一起更新的



### OLED：我不是针对谁

### 小结环节

## 参考资料

- [《计算机图形学基础（第3版）》](https://www.amazon.cn/dp/B07R4LNRR6)-陆枫, 何云峰 



















